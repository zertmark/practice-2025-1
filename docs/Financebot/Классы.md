
# –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –∫–ª–∞—Å—Å–æ–≤

## 1. –ö–ª–∞—Å—Å `Bot` (FinanceBot.py)
```mermaid
classDiagram
    class Bot {
        +token: str
        +stackCursor: Stack
        +financeCursor: Finance
        +helpMessage: str
        +commands: dict
        +table_names: dict
        
        +__init__(token, stackCursor, financeCursor)
        +setMessageHandler()
        +isSalesNumberIncorrect(remaining, sales_number): bool
        +sendExcelFile(table_name): InputFile
        +getHelpMessage(): str
        +help(): str
        +productSold(id, sales_number): str
    }
```

## 2. –ö–ª–∞—Å—Å `SQLBase` (Database.py)
```mermaid
classDiagram
    class SQLBase {
        #databasePath: str
        #dataBaseTableName: str
        #primaryKey: str
        #Cursor: sqlite3.Cursor
        #rowsCount: int
        #fields: list
        #MAX_STRING_LINES: int
        
        +__init__(database_path, table_name, primary_key_column, fields)
        +fieldsAreNotSQLCommands(fields): bool
        +getFieldsAverageSum(field): float
        +getFieldsSum(field): float
        +revealDatabaseFields(*fields): Cursor
        +revealDatabaseString(len=100): str
        +rowExists(field, data): bool
        +checkDatabasesPath(path): bool
        +newCursor(): Cursor
        +executeReadCommand(command, *args): Cursor
        +executeWriteCommand(command, *args)
        +setRowInfo(id, field, new_info)
    }
```

## 3. –ö–ª–∞—Å—Å `Stack` (Stack.py)
```mermaid
classDiagram
    class Stack {
        +fields: list
        
        +__init__(database_path)
        +getCompleteProfit(): float
        +getCompleteProfitProcent(): float
        +getCompleteCost(): float
        +getCompleteRevenue(): float
        +getAverageCostOne(): float
        +getMostProfitableProduct(): str
        +addNewDataToRow(row, remaining, cost, revenue, profit, profit_procent, cost_1): tuple
        +addNewProduct(name, remaining, cost, revenue=0, profit=0, profit_procent=0.0, cost_1=0)
        +getProductIDString(name): Cursor
        +searchProductInfo(*args): str
        +getProductInfo(id, field): tuple
        +deleteProduct(id)
    }
```

## 4. –ö–ª–∞—Å—Å `Finance` (Finance.py)
```mermaid
classDiagram
    class Finance {
        +fields: list
        
        +__init__(database_path)
        +getPlanForYear(): int
        +getCurrentMonth(): str
        +getMonthProfitID(month_name): tuple
        +getMonthProfit(month_name): int
        +getCurrentMonthPlan(): int
        +getMonthPlan(month_name): int
        +getCurrentMonthProfit(): int
        +setPlanForMonth(month_name, new_plan)
        +setProfitForMonth(month_name, new_value)
    }
```

## 5. –ö–ª–∞—Å—Å `excelWriter` (ExcelWriter.py)
```mermaid
classDiagram
    class excelWriter {
        -filePath: str
        -workSheet: Worksheet
        
        +__init__(filename, options)
        +writeColumnNames(cursor)
        +generateExcelFile(cursor)
        +getFilePath(): str
    }
```

## 6. –ö–ª–∞—Å—Å `MessageHandler` (FinanceBot.py)
```mermaid
classDiagram
    class MessageHandler {
        -bot: Bot
        -stackCursor: Stack
        -financeCursor: Finance
        -messageCount: int
        -messageChunk: int
        -messageSenderTask: asyncio.Task
        -AsyncMessageSender: AsyncMessageSender
        
        +__init__(bot, stackCursor, financeCursor)
        +extractArguments(command): list
        +areValidArguments(command, args): bool
        +handleMessage(message)
    }
```

## 7. –ö–ª–∞—Å—Å `AsyncMessageSender` (FinanceBot.py)
```mermaid
classDiagram
    class AsyncMessageSender {
        -replies_queue: list
        
        +__aiter__()
        +__anext__()
        +sendMessage(reply)
        +sendMessages()
    }
```

## 8. –û–±—Ä–∞–±–æ—Ç—á–∏–∫ –∫–æ–º–∞–Ω–¥ `commandsHandler` (commands.py)
```mermaid
classDiagram
    class commandsHandler {
        –¢–æ–ª—å–∫–æ –æ–¥–∏–Ω —Å—Ç–∞—Ç–∏—á–Ω—ã–π –º–µ—Ç–æ–¥
        
        +getCommands(bot, financeCursor, stackCursor): dict
    }
```

## üîó –°–≤—è–∑–∏ –º–µ–∂–¥—É –∫–ª–∞—Å—Å–∞–º–∏
```mermaid
flowchart LR
    Bot --> MessageHandler
    MessageHandler --> Stack
    MessageHandler --> Finance
    Stack --> SQLBase
    Finance --> SQLBase
    Bot --> excelWriter
    commandsHandler --> Bot
    AsyncMessageSender --> Bot
```

## üìå –ü–æ—è—Å–Ω–µ–Ω–∏—è:
1. **Bot**: –¶–µ–Ω—Ç—Ä–∞–ª—å–Ω—ã–π –∫–ª–∞—Å—Å, –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞—é—â–∏–π Telegram API
2. **SQLBase**: –ë–∞–∑–æ–≤—ã–π –∫–ª–∞—Å—Å –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å SQLite
3. **Stack/Finance**: –°–ø–µ—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –Ω–∞—Å–ª–µ–¥–Ω–∏–∫–∏ SQLBase –¥–ª—è –ø—Ä–µ–¥–º–µ—Ç–Ω—ã—Ö –æ–±–ª–∞—Å—Ç–µ–π
4. **excelWriter**: –ì–µ–Ω–µ—Ä–∞—Ç–æ—Ä Excel-–æ—Ç—á–µ—Ç–æ–≤ –Ω–∞ –æ—Å–Ω–æ–≤–µ xlsxwriter
5. **MessageHandler**: –û–±—Ä–∞–±–æ—Ç—á–∏–∫ –≤—Ö–æ–¥—è—â–∏—Ö —Å–æ–æ–±—â–µ–Ω–∏–π —Å –≤–∞–ª–∏–¥–∞—Ü–∏–µ–π
6. **AsyncMessageSender**: –ê—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–∞—è –æ—á–µ—Ä–µ–¥—å –æ—Ç–ø—Ä–∞–≤–∫–∏ —Å–æ–æ–±—â–µ–Ω–∏–π
7. **commandsHandler**: –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ç–æ—Ä –¥–æ—Å—Ç—É–ø–Ω—ã—Ö –∫–æ–º–∞–Ω–¥ –±–æ—Ç–∞

–ö–∞–∂–¥—ã–π –º–µ—Ç–æ–¥ —Å–æ–¥–µ—Ä–∂–∏—Ç –ø–æ–ª–Ω—ã–π –Ω–∞–±–æ—Ä –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ –∏ –≤–æ–∑–≤—Ä–∞—â–∞–µ–º—ã—Ö –∑–Ω–∞—á–µ–Ω–∏–π –≤ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–∏ —Å –∏—Å—Ö–æ–¥–Ω—ã–º –∫–æ–¥–æ–º. –í—Å–µ —Å–≤—è–∑–∏ –º–µ–∂–¥—É –∫–ª–∞—Å—Å–∞–º–∏ –æ—Ç—Ä–∞–∂–∞—é—Ç —Ä–µ–∞–ª—å–Ω—ã–µ –≤—ã–∑–æ–≤—ã –º–µ—Ç–æ–¥–æ–≤ –∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –æ–±—ä–µ–∫—Ç–æ–≤.